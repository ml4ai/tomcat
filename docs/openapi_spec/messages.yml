openapi: 3.0.0

info:
  title: ToMCAT Message Spec
  description: ToMCAT Message Spec
  version: "0.1"

paths:
  /observations/events/player_interactions/blocks/door:
    subscribe:
      responses:
        200:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DoorEvent'

  /observations/events/player_interactions/blocks/lever:
    subscribe:
      responses:
        200:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/LeverEvent'

  /observations/events/player_interactions/blocks/general:
    subscribe:
      responses:
        200:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/BlockInteraction'

  /observations/events/player_interactions/left_clicks/blocks:
    subscribe:
      responses:
        200:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DoorEvent'

  /observations/events/player_interactions/break_events/blocks:
    subscribe:
      responses:
        200:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DoorEvent'

  /observations/events/entity_death:
    subscribe:
      responses:
        200:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DoorEvent'

  /observations/chat:
    subscribe:
      responses:
        200:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DoorEvent'

  /observations/events/dog_barks:
    subscribe:
      responses:
        200:
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DoorEvent'


components:
  schemas:
    
    Position:
      description: "Position vector"
      properties:
        x:
          type: integer
        y:
          type: integer
        z:
          type: integer
          
    Velocity:
      description: "Velocity vector"
      properties:
        x:
          type: number
        y:
          type: number
        z:
          type: number

    Event:
      properties:
        timestamp:
          type: string
          format: date-time
        event_type:
          type: string

    DoorEvent:
      allOf:
        - $ref: '#/components/schemas/Event'
        - type: object
      properties:
        player_name:
          type: string
          example: "Aptiminer1"
        was_open:
          type: boolean
        door_position:
          $ref: '#/components/schemas/Position'
      description: "Door event."

    LeverEvent:
      allOf:
      - $ref: '#/components/schemas/Event'
      properties:
        event_type:
          type: string
          enum:
            - "lever"
        player_name:
          $ref: '#/components/schemas/PlayerName'
        was_powered:
          type: boolean
        lever_position:
          $ref: '#/components/schemas/Position'
      description: "Lever event."


    BlockInteraction:
      properties:
        allOf:
        - $ref: '#/components/schemas/Event'
        player_name:
          type: string
        block_position:
          $ref: '#/components/schemas/Position'
        block_material:
          $ref: '#/components/schemas/BlockMaterial'
        click_type:
          $ref: '#/components/schemas/ClickType'
        item_held:
          type: string

    EventType:
      type: string
      enum:
        - "Event:Lever"
        - "Event:Door"

    PlayerName:
      type: string
      example: tomcat

    BlockMaterial:
      type: string
      enum:
        - minecraft:air
        - minecraft:anvil
        - minecraft:barrier
        - minecraft:cactus
        - minecraft:cake
        - minecraft:carpet
        - minecraft:circuits
        - minecraft:clay
        - minecraft:cloth
        - minecraft:coral
        - minecraft:crafted_snow
        - minecraft:dragon_egg
        - minecraft:fire
        - minecraft:glass
        - minecraft:gourd
        - minecraft:grass
        - minecraft:ground
        - minecraft:ice
        - minecraft:iron
        - minecraft:lava
        - minecraft:leaves
        - minecraft:packed_ice
        - minecraft:piston
        - minecraft:plants
        - minecraft:portal
        - minecraft:redstone_light
        - minecraft:rock
        - minecraft:sand
        - minecraft:snow
        - minecraft:sponge
        - minecraft:structure_void
        - minecraft:tnt
        - minecraft:vine
        - minecraft:water
        - minecraft:web
        - minecraft:wood

    ClickType:
      type: string
      enum:
        - right
        - left
